# Компоненты

Для визуализации дерева нам необходимо типисировать его узлы.
Допустим мы знаем что в нашем дереве встречается несколько типов объетов, каждый из которых мы хотим отрисовывать во своему. Для этого и нужны компоненты.

Объет конфигурации компонента имеет 3 обязателных свойства:

- `model`
- `chaldsKey`
- `widgets`

## Модель

`model` - объект по которому `muup` будет определять к какому узлу применим этот компонент. В нем необходимо описать свойства искомого объекта, по которым и будет происходить поиск, а также те свойства которые мы хотим визуализировать.

Допустим в нашем дереве есть объект который мы назавем `server`.

```json
{
  "id": 4091209,
  "name": "Server #1",
  "object_type": "server",
  "status": {
    "color": "red",
    "message": "Down!"
  },
  "metrics": [],
  "childs": [...] // дочерние  узлы
}
```

**Можно явно сравнивать свойства с задаными значениямм.**

Мы знаем что все подобные этому объекту узлы содержат поле `object_type` со значением `"server"`.

```js
{
  object_type: "server";
}
```

**Иногда необходимо не явное сравнение**

Мы знаем что все подобные этому объекту узлы содержат поле `name` и его значение имеет вид `"Server #<номер>"`, для определения таких объектов мы можем использовать регулярные выражения.

```js
{
  name: /^(Server #)([0-9]*)/;
}
```

> Eсли значение свойства не строка, то оно преобразуется к строке `JSON`, после чего будет проверено регулярным выражением.

Возможна ситуация когды мы знаем только тип свойва

```js
{
  metrics: [Array, Null];
}
```

> Будут найдены все узлы у которых есть свойство `metrics`, и тип которого соответсвует либо `Array` либо `Null`

**Если свойство является объектом**

Вложенные свойства описываются по принцепам описанным выше.

```js
{
  status: {
    color: [String];
  }
}
```

## Ключ массива дочерних элементов

`childsKey` - ключ массива объекта, который содержит дочерниe элементы. Необходим для отрисовки дерева.

## Виджеты

`widgets` - массив конфигураций для [виджетов](./widgets.md).

Конфигурация виджета содержит два поля `name` и `map`, `name` - имя под которым зарегистрирован виджет, `map` - объект описываюший какие свойства `model` необходимо установить определенному свойству виджета.

```js
[
  {
    name: "Status",
    map: {
      color: "status.color",
    },
  },
];
```

## Итог

```js
const server = {
  model: {
    object_type: "server",
    name: /^(Server #)([0-9]*)/,
    status: {
      color: [String],
    },
  },
  childsKey: "childs",
  widgets: {
    name: "Status",
    map: {
      color: "status.color",
    },
  },
};

muup.useComponent("Server", server);
```
